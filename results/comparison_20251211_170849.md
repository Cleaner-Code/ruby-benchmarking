# Ruby Benchmark Comparison

_Generated: 2025-12-11 17:08:49_

## Versions Compared

- **MRI**: `ruby 3.4.7p58`
- **JRuby 10**: `JRuby 10.0.2.0 (3.4.2) [21.0.9]`
- **JRuby 1.7**: `JRuby 1.7.27 (1.9.3) [1.8.0_472]`

## Technique Comparisons

Format: **time** (gc, heap MB) | \* = best for that Ruby

### String Building

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| + operator | **0.0017 (1, 51.5MB)** | 0.0026 (1, 50.9MB) | 0.0023 (125.6MB) | MRI |
| << shovel | **0.0001 (51.6MB)** | 0.0004\* (54.9MB) | 0.0003\* (128.1MB) | MRI |
| Array#join | **0.0000\* (51.6MB)** | 0.0004 (54.9MB) | 0.0003 (128.1MB) | MRI |
| StringIO | **0.0002 (51.6MB)** | 0.0008 (54.9MB) | 0.0008 (130.6MB) | MRI |
| concat | **0.0001 (51.6MB)** | 0.0005 (54.9MB) | 0.0003 (128.1MB) | MRI |
| each_with_object | **0.0001 (51.6MB)** | 0.0006 (54.9MB) | 0.0004 (133.0MB) | MRI |
| inject << | **0.0001 (51.6MB)** | 0.0006 (58.9MB) | 0.0012 (1, 15.9MB) | MRI |
| interpolation | **0.0022 (1, 53.9MB)** | 0.0028 (1, 70.8MB) | 0.0023 (1, 15.8MB) | MRI |

> **MRI**: Array#join | **JRuby 10**: << shovel | **JRuby 1.7**: << shovel

### Array Iteration

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| each + var | 0.0323 (63.0MB) | **0.0222 (356.6MB)** | 0.0465 (2, 171.5MB) | JRuby 10 |
| for in | 0.0363 (63.0MB) | **0.0173 (371.1MB)** | 0.0395 (1, 131.4MB) | JRuby 10 |
| reduce block | **0.0395 (63.0MB)** | 0.0498 (391.6MB) | 0.0742 (5, 153.5MB) | MRI |
| reduce(:+) | **0.0011\* (63.0MB)** | 0.0260 (1, 104.5MB) | 0.0265\* (2, 88.3MB) | MRI |
| sum | **0.0015 (63.0MB)** | 0.0126\* (134.8MB) | - | MRI |
| while index | **0.0339 (63.0MB)** | 0.1414 (407.3MB) | 0.0893 (2, 156.4MB) | MRI |

> **MRI**: reduce(:+) | **JRuby 10**: sum | **JRuby 1.7**: reduce(:+)

### Array Building

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| << in times | 0.0035 (67.5MB) | **0.0021 (131.4MB)** | 0.0050 (1, 85.4MB) | JRuby 10 |
| Array.new block | **0.0029 (66.6MB)** | 0.0035 (443.1MB) | 0.0037 (1, 84.5MB) | MRI |
| Range#map | 0.0037 (67.3MB) | **0.0026 (1, 87.4MB)** | 0.0039 (149.5MB) | JRuby 10 |
| Range#to_a | 0.0014\* (64.3MB) | 0.0015\* (403.1MB) | **0.0005\* (158.8MB)** | JRuby 1.7 |
| each_with_object | 0.0045 (67.5MB) | **0.0032 (219.4MB)** | 0.0125 (143.3MB) | JRuby 10 |
| push in times | 0.0041 (67.5MB) | **0.0020 (175.4MB)** | 0.0075 (162.1MB) | JRuby 10 |

> **All agree**: Range#to_a

### Array Sorting

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| sort | **0.0094 (67.5MB)** | 0.0215 (243.4MB) | 0.0127 (184.1MB) | MRI |
| sort block | **0.0386 (67.5MB)** | 0.1019 (451.4MB) | 0.0577 (2, 180.7MB) | MRI |
| sort! | **0.0094\* (67.5MB)** | 0.0278 (263.4MB) | 0.0103\* (85.6MB) | MRI |
| sort_by | **0.0095 (67.5MB)** | 0.0261 (1, 91.7MB) | 0.0304 (98.1MB) | MRI |
| sort_by(&:itself) | **0.0095 (67.5MB)** | 0.0204\* (139.7MB) | - | MRI |

> **MRI**: sort! | **JRuby 10**: sort_by(&:itself) | **JRuby 1.7**: sort!

### Hash Building

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| Hash[] | **0.0080 (1, 90.1MB)** | 0.0111\* (395.7MB) | 0.0086\* (1, 77.0MB) | MRI |
| []= loop | **0.0075 (76.0MB)** | 0.0158 (195.7MB) | 0.0139 (200.2MB) | MRI |
| each_with_object | **0.0095 (91.0MB)** | 0.0172 (283.7MB) | 0.0191 (184.4MB) | MRI |
| map.to_h | **0.0099 (1, 90.9MB)** | 0.0151 (359.7MB) | - | MRI |
| zip.to_h | **0.0055\* (1, 82.4MB)** | 0.0132 (231.7MB) | - | MRI |

> **MRI**: zip.to_h | **JRuby 10**: Hash[] | **JRuby 1.7**: Hash[]

### Hash Access

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| [] existing | **0.0351\* (150.2MB)** | 0.0485 (304.6MB) | 0.0584\* (1, 227.6MB) | MRI |
| [] missing | **0.0443 (161.8MB)** | 0.0473 (464.6MB) | 0.0651 (2, 181.4MB) | MRI |
| dig | **0.0370 (161.8MB)** | 0.0478 (415.4MB) | - | MRI |
| fetch default | 0.0474 (161.8MB) | **0.0443 (251.4MB)** | 0.0627 (2, 184.8MB) | JRuby 10 |
| fetch existing | **0.0382 (161.8MB)** | 0.0431\* (384.6MB) | 0.0809 (1, 231.3MB) | MRI |
| \|\| default | **0.0482 (161.8MB)** | 0.0486 (331.4MB) | 0.0682 (2, 183.6MB) | MRI |

> **MRI**: [] existing | **JRuby 10**: fetch existing | **JRuby 1.7**: [] existing

### Hash Key Iteration

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| each { \|k,_\| } | 1.5958 (166, 101.7MB) | **1.0481 (20, 415.7MB)** | 2.5997 (87, 197.8MB) | JRuby 10 |
| each_key.map | 1.7085 (176, 128.0MB) | 1.8187 (23, 547.8MB) | **1.5543\* (70, 244.7MB)** | JRuby 1.7 |
| keys.each | 1.5436 (166, 101.7MB) | **1.1061 (21, 306.7MB)** | 1.7491 (63, 216.3MB) | JRuby 10 |
| keys.map | 1.4375\* (157, 147.0MB) | **0.9466\* (19, 536.5MB)** | 1.5783 (59, 297.0MB) | JRuby 10 |
| map { \|k,_\| } | 1.7365 (176, 142.5MB) | **1.6254 (31, 511.8MB)** | 2.4013 (95, 277.9MB) | JRuby 10 |

> **MRI**: keys.map | **JRuby 10**: keys.map | **JRuby 1.7**: each_key.map

### Conditionals

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| array lookup | **0.0313\* (141.7MB)** | 0.0328 (1, 146.7MB) | 0.0439\* (1, 334.4MB) | MRI |
| case/when | 0.1313 (141.7MB) | **0.0564 (526.7MB)** | 0.1113 (2, 282.2MB) | JRuby 10 |
| hash lookup | **0.0463 (141.7MB)** | 0.0562 (202.7MB) | 0.0585 (1, 307.2MB) | MRI |
| if/elsif | 0.0463 (142.2MB) | **0.0234\* (362.7MB)** | 0.0571 (1, 342.0MB) | JRuby 10 |
| ternary | 0.0469 (122.4MB) | **0.0237 (607.7MB)** | 0.0552 (1, 314.7MB) | JRuby 10 |

> **MRI**: array lookup | **JRuby 10**: if/elsif | **JRuby 1.7**: array lookup

### Loops

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| loop+break | **0.0462 (141.7MB)** | 0.0672 (1, 258.7MB) | 0.1019 (1, 370.4MB) | MRI |
| range.each | 0.0325 (141.7MB) | **0.0228 (1, 242.5MB)** | 0.0504 (2, 326.1MB) | JRuby 10 |
| step | 0.0323 (141.7MB) | **0.0205\* (1, 254.6MB)** | 0.0533 (3, 276.4MB) | JRuby 10 |
| times | 0.0407 (141.7MB) | **0.0220 (1, 282.5MB)** | 0.0498 (3, 259.3MB) | JRuby 10 |
| upto | 0.0326 (141.7MB) | **0.0250 (1, 174.5MB)** | 0.0524 (2, 378.2MB) | JRuby 10 |
| while | **0.0295\* (141.7MB)** | 0.1205 (1, 122.4MB) | 0.0428\* (1, 301.7MB) | MRI |

> **MRI**: while | **JRuby 10**: step | **JRuby 1.7**: while

### String Search

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| =~ regex | **0.2725 (46, 149.8MB)** | 0.3149 (307.3MB) | 0.3000 (2, 50.0MB) | MRI |
| [] | 0.1970 (3, 141.7MB) | **0.0757 (326.7MB)** | 0.0788 (347.5MB) | JRuby 10 |
| include? | 0.1952 (141.7MB) | **0.0764 (286.7MB)** | 0.0789 (270.7MB) | JRuby 10 |
| index | 0.1955 (141.7MB) | **0.0777 (298.7MB)** | 0.0788 (304.1MB) | JRuby 10 |
| match? | **0.2444 (19, 149.6MB)** | 0.2895 (255.3MB) | - | MRI |
| start_with? | 0.0049\* (149.8MB) | **0.0030\* (323.3MB)** | 0.0342\* (8, 47.3MB) | JRuby 10 |

> **All agree**: start_with?

### Filtering

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| each + << | 0.0180 (165.2MB) | **0.0105 (1, 114.1MB)** | 0.0240 (1, 78.0MB) | JRuby 10 |
| filter_map | 0.0216 (171.0MB) | **0.0126 (370.1MB)** | - | JRuby 10 |
| partition[0] | **0.0223 (171.0MB)** | 0.0296 (282.1MB) | 0.0228 (193.9MB) | MRI |
| reject | 0.0156\* (159.4MB) | **0.0067\* (323.2MB)** | 7.3037 (1, 54.5MB) | JRuby 10 |
| select | 0.0157 (153.6MB) | **0.0082 (1, 131.2MB)** | 0.0231 (1, 96.4MB) | JRuby 10 |
| select &:even? | 0.0228 (153.6MB) | 0.0173 (235.2MB) | **0.0112\* (181.6MB)** | JRuby 1.7 |

> **MRI**: reject | **JRuby 10**: reject | **JRuby 1.7**: select &:even?

### Transform

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| collect | 0.0152\* (172.3MB) | **0.0097 (446.5MB)** | 0.0247 (1, 170.2MB) | JRuby 10 |
| each_with_object | 0.0242 (168.0MB) | **0.0153 (364.8MB)** | 0.0666 (2, 156.7MB) | JRuby 10 |
| inject | **0.0256 (164.2MB)** | 0.0295 (2, 278.8MB) | 0.0429 (2, 150.2MB) | MRI |
| map | 0.0155 (172.3MB) | **0.0093 (320.0MB)** | 0.0239\* (1, 109.7MB) | JRuby 10 |
| map &proc | 0.0156 (172.3MB) | **0.0091\* (254.5MB)** | 0.0271 (1, 148.7MB) | JRuby 10 |

> **MRI**: collect | **JRuby 10**: map &proc | **JRuby 1.7**: map

### Number Conversion

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| Integer() | **0.0061 (166.3MB)** | 0.0065\* (405.0MB) | 0.0082 (1, 110.9MB) | MRI |
| Integer(s,10) | 0.0088 (166.3MB) | 0.0096 (1, 243.2MB) | **0.0078 (202.8MB)** | JRuby 1.7 |
| map { to_i } | **0.0058 (166.3MB)** | 0.0068 (329.0MB) | 0.0097 (1, 129.3MB) | MRI |
| map(&:to_i) | 0.0049\* (166.3MB) | 0.0077 (1, 253.0MB) | **0.0046\* (152.9MB)** | JRuby 1.7 |

> **MRI**: map(&:to_i) | **JRuby 10**: Integer() | **JRuby 1.7**: map(&:to_i)

### Nil Handling

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| compact.sum | **0.0020\* (183.8MB)** | 0.0040\* (527.2MB) | - | MRI |
| nil? ? 0 : itself | 0.0215 (183.8MB) | **0.0128 (607.2MB)** | - | JRuby 10 |
| to_i | 0.0256 (183.8MB) | **0.0119 (507.2MB)** | 0.0251 (1, 168.2MB) | JRuby 10 |
| v.nil? ternary | 0.0182 (183.9MB) | **0.0121 (427.2MB)** | 0.0287 (1, 122.1MB) | JRuby 10 |
| \|\| default | 0.0171 (177.9MB) | **0.0117 (347.2MB)** | 0.0190\* (195.8MB) | JRuby 10 |

> **MRI**: compact.sum | **JRuby 10**: compact.sum | **JRuby 1.7**: \|\| default

### Object Duplication

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| Hash[] | 0.0096 (2, 206.9MB) | **0.0090 (723.4MB)** | 0.0098 (1, 112.4MB) | JRuby 10 |
| clone | 0.0146 (2, 200.4MB) | **0.0137 (563.4MB)** | 0.0145 (1, 177.7MB) | JRuby 10 |
| dup | 0.0151 (3, 207.9MB) | **0.0089 (1, 331.4MB)** | 0.0139 (1, 116.8MB) | JRuby 10 |
| merge({}) | 0.0232 (9, 216.4MB) | **0.0098 (1, 335.9MB)** | 0.0142 (1, 129.1MB) | JRuby 10 |
| to_h | 0.0050\* (208.6MB) | **0.0023\* (343.9MB)** | 0.0054\* (151.4MB) | JRuby 10 |

> **All agree**: to_h

### Method Invocation

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| __send__ | 0.0338 (190.1MB) | **0.0275 (691.9MB)** | 0.0289 (128.2MB) | JRuby 10 |
| direct | 0.0211\* (202.6MB) | **0.0087\* (347.9MB)** | 0.0214\* (1, 111.8MB) | JRuby 10 |
| method.call | 0.0424 (192.0MB) | **0.0116 (599.9MB)** | 0.0219 (169.0MB) | JRuby 10 |
| public_send | 0.0461 (194.6MB) | **0.0296 (599.9MB)** | 0.0330 (1, 99.0MB) | JRuby 10 |
| send | 0.0330 (198.1MB) | **0.0277 (439.9MB)** | 0.0290 (180.5MB) | JRuby 10 |

> **All agree**: direct

### Block/Yield

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| block.call | 0.0912 (187.4MB) | **0.0384 (707.9MB)** | 0.1243 (2, 209.6MB) | JRuby 10 |
| each { } | 0.0133\* (185.0MB) | **0.0088 (779.9MB)** | 0.0185\* (200.9MB) | JRuby 10 |
| lambda.call | 0.0907 (185.4MB) | **0.0506 (711.9MB)** | 0.1374 (2, 194.8MB) | JRuby 10 |
| map { } | 0.0188 (158.5MB) | **0.0088\* (859.9MB)** | 0.0188 (221.3MB) | JRuby 10 |
| nested yield | 0.1181 (186.5MB) | **0.0394 (707.9MB)** | 0.1546 (2, 229.7MB) | JRuby 10 |
| no block baseline | 0.0690 (159.9MB) | **0.0141 (554.6MB)** | 0.0700 (1, 117.3MB) | JRuby 10 |
| proc.call | 0.0914 (185.9MB) | **0.0397 (707.9MB)** | 0.1249 (2, 207.2MB) | JRuby 10 |
| select { } | 0.0175 (160.1MB) | **0.0098 (276.6MB)** | 0.0225 (238.7MB) | JRuby 10 |
| unused closure (&block) | 0.1165 (159.9MB) | **0.0625 (1, 414.1MB)** | 0.2539 (7, 234.1MB) | JRuby 10 |
| unused closure (yield) | 0.0863 (159.9MB) | **0.0623 (1, 554.6MB)** | 0.1348 (5, 245.9MB) | JRuby 10 |
| yield | 0.0874 (188.6MB) | **0.0277 (707.9MB)** | 0.1023 (2, 152.0MB) | JRuby 10 |

> **MRI**: each { } | **JRuby 10**: map { } | **JRuby 1.7**: each { }

### Eval

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| binding.eval | 0.1856 (18, 105.0MB) | 0.4882 (5, 255.4MB) | **0.0343 (4, 138.3MB)** | JRuby 1.7 |
| class_eval blk | 0.0047 (3, 166.3MB) | **0.0042 (759.3MB)** | 0.0076 (258.4MB) | JRuby 10 |
| class_eval str | 0.2046 (18, 166.7MB) | 0.3503 (4, 671.3MB) | **0.0416 (4, 178.2MB)** | JRuby 1.7 |
| direct (baseline) | 0.0017\* (104.8MB) | **0.0008\* (255.4MB)** | 0.0016\* (145.0MB) | JRuby 10 |
| eval simple | 0.2074 (18, 164.6MB) | 0.3395 (4, 370.1MB) | **0.0352 (4, 197.3MB)** | JRuby 1.7 |
| eval vars | 0.2366 (18, 166.1MB) | 0.3952 (4, 399.2MB) | **0.0748 (4, 224.7MB)** | JRuby 1.7 |
| instance_eval blk | **0.0049 (3, 165.7MB)** | 0.0093 (1, 247.2MB) | 0.0077 (241.5MB) | MRI |
| instance_eval str | 0.2063 (18, 166.1MB) | 0.3542 (3, 827.2MB) | **0.0420 (4, 158.0MB)** | JRuby 1.7 |

> **All agree**: direct (baseline)

### Caller

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| caller() | **0.4158 (723, 105.2MB)** | 2.3868 (6, 627.5MB) | 4.4684\* (19, 128.4MB) | MRI |
| caller(0) | **0.4848 (831, 105.3MB)** | 2.4099 (6, 687.5MB) | 4.4906 (20, 242.0MB) | MRI |
| caller(0, 1) | **0.0727 (108, 105.4MB)** | 0.4803 (2, 435.5MB) | - | MRI |
| caller(0, 5) | **0.2703 (470, 105.6MB)** | 2.7730 (8, 255.6MB) | - | MRI |
| caller_locations(0, 1) | **0.0193\* (54, 105.9MB)** | 0.4729\* (2, 315.6MB) | - | MRI |
| caller_locations(0, 5) | **0.0460 (325, 105.8MB)** | 2.6645 (6, 727.6MB) | - | MRI |

> **MRI**: caller_locations(0, 1) | **JRuby 10**: caller_locations(0, 1) | **JRuby 1.7**: caller()

### Marshal

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| dump only medium 1k | **0.0261 (162.4MB)** | 0.0393 (791.7MB) | 0.0450 (242.1MB) | MRI |
| dump/load medium 1k | **0.0555 (2, 146.8MB)** | 0.1312 (587.7MB) | 0.0763 (2, 158.6MB) | MRI |
| dump/load small 1k | **0.0022\* (1, 106.2MB)** | 0.0044\* (743.6MB) | 0.0041\* (1, 95.0MB) | MRI |
| load only medium 1k | **0.0292 (1, 165.3MB)** | 0.0904 (431.8MB) | 0.0310 (1, 218.7MB) | MRI |

> **All agree**: dump/load small 1k

### Memoization

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| fetch block 100k | **0.0057 (164.7MB)** | 0.0079 (583.8MB) | 0.0125 (228.7MB) | MRI |
| ivar \|\|= 100k | **0.0054\* (164.3MB)** | 0.0062\* (623.8MB) | 0.0072\* (135.2MB) | MRI |
| key? + []= 100k | **0.0066 (164.5MB)** | 0.0066 (623.8MB) | 0.0146 (1, 115.2MB) | MRI |
| \|\|= hash key 100k | **0.0069 (164.9MB)** | 0.0094 (471.8MB) | 0.0107 (1, 108.5MB) | MRI |

> **All agree**: ivar \|\|= 100k

### Set vs Array

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| Array#include? 10 100k | 0.0050 (164.1MB) | **0.0023 (627.8MB)** | 0.0043 (148.6MB) | JRuby 10 |
| Array#include? 1k 10k | 0.0191 (166.6MB) | 0.0143 (340.0MB) | **0.0047 (101.9MB)** | JRuby 1.7 |
| Set reuse 10 100k | 0.0050 (166.6MB) | **0.0014\* (340.0MB)** | 0.0059 (101.9MB) | JRuby 10 |
| Set reuse 1k 10k | **0.0006\* (256.5MB)** | 0.0014 (772.1MB) | 0.0007\* (155.8MB) | MRI |
| Set.new+incl 10 100k | 0.1658 (36, 166.8MB) | **0.0169 (1, 340.0MB)** | 0.1200 (2, 255.5MB) | JRuby 10 |
| Set.new+incl 1k 10k | 0.9072 (16, 256.5MB) | **0.2927 (2, 772.1MB)** | 0.5942 (16, 155.8MB) | JRuby 10 |

> **MRI**: Set reuse 1k 10k | **JRuby 10**: Set reuse 10 100k | **JRuby 1.7**: Set reuse 1k 10k

### Mutex

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| lock/unlock 100k | 0.0086 (256.5MB) | **0.0042 (248.1MB)** | 0.0095 (179.2MB) | JRuby 10 |
| no sync 100k | 0.0041\* (256.5MB) | **0.0015\* (796.1MB)** | 0.0038\* (192.5MB) | JRuby 10 |
| synchronize 100k | 0.0113 (256.5MB) | **0.0079 (892.1MB)** | 0.0133 (1, 142.4MB) | JRuby 10 |
| try_lock 100k | 0.0071 (256.5MB) | **0.0043 (272.1MB)** | 0.0100 (215.9MB) | JRuby 10 |

> **All agree**: no sync 100k

### Thread-local

| Technique | MRI | JRuby 10 | JRuby 1.7 | Winner |
|:----------|----------:|----------:|----------:|:------:|
| current[] read 100k | 0.0051 (256.5MB) | **0.0020 (272.1MB)** | 0.0048 (229.3MB) | JRuby 10 |
| current[] write 100k | 0.0059 (256.5MB) | **0.0023 (272.1MB)** | 0.0103 (1, 99.0MB) | JRuby 10 |
| ivar read 100k | 0.0044 (256.5MB) | **0.0015 (272.1MB)** | 0.0044 (112.4MB) | JRuby 10 |
| local var 100k | 0.0030\* (256.5MB) | **0.0010\* (272.1MB)** | 0.0030\* (125.8MB) | JRuby 10 |

> **All agree**: local var 100k

## Operation Benchmarks

Format: **time** (gc collections, heap MB)

| Benchmark | MRI | JRuby 10 | JRuby 1.7 | Winner | Factor |
|:----------|----------:|----------:|----------:|:------:|-------:|
| Array creation (Array.new) | 0.3013 (5, 402.1MB) | **0.2884 (2, 752.7MB)** | 0.4275 (15, 230.0MB) | JRuby 10 | 1.5x |
| Array creation (literal) | 0.0046 (6, 315.7MB) | **0.0009 (772.4MB)** | 0.0073 (257.1MB) | JRuby 10 | 7.9x |
| Array#compact | 0.0387 (1, 479.4MB) | **0.0310 (875.4MB)** | 0.0567 (2, 123.7MB) | JRuby 10 | 1.8x |
| Array#each | **0.0326 (426.2MB)** | 0.0331 (775.6MB) | 0.0581 (1, 240.6MB) | MRI | 1.8x |
| Array#flatten | 0.0343 (3, 450.4MB) | **0.0204 (463.4MB)** | 0.0353 (1, 154.7MB) | JRuby 10 | 1.7x |
| Array#include? | 0.2547 (492.9MB) | 0.1878 (430.4MB) | **0.0599 (142.8MB)** | JRuby 1.7 | 4.3x |
| Array#index | 0.2749 (492.3MB) | 0.2037 (438.4MB) | **0.1110 (155.5MB)** | JRuby 1.7 | 2.5x |
| Array#map | **0.0154 (426.7MB)** | 0.0171 (1, 427.7MB) | 0.0235 (1, 229.0MB) | MRI | 1.5x |
| Array#push (append) | 0.0211 (426.1MB) | **0.0140 (1, 399.6MB)** | 0.0569 (2, 147.0MB) | JRuby 10 | 4.0x |
| Array#reduce | **0.0400 (432.9MB)** | 0.0492 (1, 435.7MB) | 0.0793 (3, 273.0MB) | MRI | 2.0x |
| Array#select | 0.0157 (432.8MB) | **0.0113 (511.7MB)** | 0.0220 (250.6MB) | JRuby 10 | 1.9x |
| Array#sort | **0.0247 (434.7MB)** | 0.0409 (511.7MB) | 0.0254 (179.8MB) | MRI | 1.7x |
| Array#sort_by | **0.0639 (29, 442.5MB)** | 0.0936 (959.7MB) | 0.0992 (1, 244.8MB) | MRI | 1.6x |
| Array#uniq | 0.0452 (1, 493.6MB) | **0.0397 (1, 426.4MB)** | 0.0506 (1, 133.3MB) | JRuby 10 | 1.3x |
| Array#unshift (prepend) | **0.0005 (426.2MB)** | 0.0053 (407.6MB) | 0.0054 (153.3MB) | MRI | 11.4x |
| CSV.generate | 0.0974 (101, 712.9MB) | **0.0515 (1205.5MB)** | 0.0867 (4, 369.4MB) | JRuby 10 | 1.9x |
| CSV.parse | 0.1062 (85, 712.9MB) | **0.0926 (2178.0MB)** | 0.1170 (4, 307.1MB) | JRuby 10 | 1.3x |
| Date.parse | **0.0206 (5, 713.4MB)** | 0.0791 (1685.5MB) | 0.1329 (2, 442.3MB) | MRI | 6.5x |
| Deep hash tree creation | **0.0116 (19, 671.8MB)** | 0.0122 (1883.2MB) | 0.0137 (1, 312.3MB) | MRI | 1.2x |
| Float() parsing | **0.0077 (712.9MB)** | 0.0479 (1525.5MB) | 0.0257 (1, 392.7MB) | MRI | 6.2x |
| Frozen string literals | 0.0038 (315.7MB) | **0.0015 (740.4MB)** | 0.0049 (183.7MB) | JRuby 10 | 3.2x |
| Hash creation (from array) | 0.2420 (205, 488.0MB) | **0.1595 (2, 380.0MB)** | 0.3582 (10, 124.1MB) | JRuby 10 | 2.2x |
| Hash creation (literal) | 0.0184 (54, 487.7MB) | **0.0123 (814.4MB)** | 0.0202 (1, 171.8MB) | JRuby 10 | 1.6x |
| Hash map keys | **0.1760 (65, 657.3MB)** | 0.2416 (1483.4MB) | 0.2365 (5, 412.1MB) | MRI | 1.4x |
| Hash map values | **0.0828 (3, 653.5MB)** | 0.1350 (2091.4MB) | 0.2218 (4, 416.2MB) | MRI | 2.7x |
| Hash#[] (read) | **0.1524 (488.0MB)** | 0.1559 (608.0MB) | 0.1810 (2, 139.1MB) | MRI | 1.2x |
| Hash#[]= (write) | **0.1360 (4, 599.2MB)** | 0.7020 (783.0MB) | 0.5045 (7, 339.3MB) | MRI | 5.2x |
| Hash#[]= 10k int keys x50 | **0.0343 (1, 627.2MB)** | 0.0540 (2, 727.7MB) | 0.0353 (1, 266.3MB) | MRI | 1.6x |
| Hash#[]= 500k frozen string keys | **0.0632 (1, 614.2MB)** | 0.2982 (758.1MB) | 0.4198 (4, 209.3MB) | MRI | 6.6x |
| Hash#[]= 500k int keys | **0.0416 (1, 580.6MB)** | 0.2621 (1, 664.7MB) | 0.0433 (3, 108.2MB) | MRI | 6.3x |
| Hash#[]= 500k string keys | **0.2263 (20, 613.1MB)** | 0.6495 (3, 704.6MB) | 0.7686 (10, 322.8MB) | MRI | 3.4x |
| Hash#[]= 500k symbol keys | **0.4971 (10, 659.6MB)** | 0.9388 (2, 737.0MB) | 0.7624 (12, 202.2MB) | MRI | 1.9x |
| Hash#each | **0.0896 (620.9MB)** | 0.1122 (1646.9MB) | 0.2887 (10, 227.2MB) | MRI | 3.2x |
| Hash#keys 500k | **0.0340 (33, 657.2MB)** | 0.4577 (1, 977.0MB) | 0.5527 (7, 307.7MB) | MRI | 16.2x |
| Hash#keys and Hash#values | **0.0159 (13, 624.3MB)** | 0.6102 (1118.5MB) | 0.7982 (2, 246.3MB) | MRI | 50.3x |
| Hash#merge | **0.2487 (41, 657.3MB)** | 0.5136 (1, 1971.0MB) | 0.9493 (15, 350.6MB) | MRI | 3.8x |
| Hash#select | **0.1068 (9, 674.8MB)** | 0.2144 (1477.4MB) | 0.3476 (7, 314.7MB) | MRI | 3.3x |
| Hash#to_a | 0.1545 (99, 679.0MB) | **0.0502 (1787.2MB)** | 0.0861 (8, 309.9MB) | JRuby 10 | 3.1x |
| Integer() parsing | **0.0057 (712.9MB)** | 0.0157 (1281.5MB) | 0.0089 (1, 301.3MB) | MRI | 2.7x |
| JSON.generate | **0.0411 (1, 711.6MB)** | 0.0826 (1806.0MB) | 0.1194 (4, 411.2MB) | MRI | 2.9x |
| JSON.parse | **0.0618 (73, 671.8MB)** | 0.2906 (1514.0MB) | 0.2319 (5, 399.1MB) | MRI | 4.7x |
| Java HashMap 500k int keys | - | **0.0286 (1, 936.2MB)** | 0.0598 (3, 247.5MB) | JRuby 10 | 2.1x |
| Line-by-line parsing | 0.0429 (88, 715.1MB) | 0.0731 (2249.5MB) | **0.0243 (1, 440.6MB)** | JRuby 1.7 | 3.0x |
| Nested hash access | 0.2708 (672.7MB) | **0.2302 (1653.4MB)** | 0.2908 (2, 311.8MB) | JRuby 10 | 1.3x |
| Regex extraction | **0.0074 (17, 713.6MB)** | 0.0117 (1733.5MB) | 0.0074 (334.6MB) | MRI | 1.6x |
| String encoding conversion | 0.0646 (1, 315.8MB) | 0.1182 (736.4MB) | **0.0329 (2, 139.8MB)** | JRuby 1.7 | 3.6x |
| String#gsub (regex) | 0.5526 (1502, 256.9MB) | **0.2023 (732.6MB)** | 0.2264 (7, 185.6MB) | JRuby 10 | 2.7x |
| String#match | **0.0333 (54, 256.8MB)** | 0.0410 (452.4MB) | 0.0487 (1, 156.3MB) | MRI | 1.5x |
| String#scan (regex) | 0.3742 (819, 256.9MB) | 0.1794 (2, 868.4MB) | **0.1576 (4, 159.8MB)** | JRuby 1.7 | 2.4x |
| String#split | 0.1180 (187, 256.6MB) | 0.0615 (1, 320.6MB) | **0.0544 (4, 179.3MB)** | JRuby 1.7 | 2.2x |
| Tokenization (scan) | 0.0251 (52, 713.5MB) | 0.0237 (1949.5MB) | **0.0159 (416.5MB)** | JRuby 1.7 | 1.6x |

## Summary

### Technique Wins

| Ruby | Wins |
|:-----|-----:|
| MRI | 55 |
| JRuby 10 | 69 |
| JRuby 1.7 | 11 |

### Operation Wins

| Ruby | Wins |
|:-----|-----:|
| MRI | 28 |
| JRuby 10 | 16 |
| JRuby 1.7 | 7 |

### Overall

| Ruby | Total Wins |
|:-----|----------:|
| JRuby 10 | 85 |
| MRI | 83 |
| JRuby 1.7 | 18 |

## Recommendations

Best technique to use for each category:

| Category | Recommendation |
|:---------|:---------------|
| String Building | MRI: `Array#join`, JRuby 10: `<< shovel`, JRuby 1.7: `<< shovel` |
| Array Iteration | MRI: `reduce(:+)`, JRuby 10: `sum`, JRuby 1.7: `reduce(:+)` |
| Array Building | `Range#to_a` |
| Array Sorting | MRI: `sort!`, JRuby 10: `sort_by(&:itself)`, JRuby 1.7: `sort!` |
| Hash Building | MRI: `zip.to_h`, JRuby 10: `Hash[]`, JRuby 1.7: `Hash[]` |
| Hash Access | MRI: `[] existing`, JRuby 10: `fetch existing`, JRuby 1.7: `[] existing` |
| Hash Key Iteration | MRI: `keys.map`, JRuby 10: `keys.map`, JRuby 1.7: `each_key.map` |
| Conditionals | MRI: `array lookup`, JRuby 10: `if/elsif`, JRuby 1.7: `array lookup` |
| Loops | MRI: `while`, JRuby 10: `step`, JRuby 1.7: `while` |
| String Search | `start_with?` |
| Filtering | MRI: `reject`, JRuby 10: `reject`, JRuby 1.7: `select &:even?` |
| Transform | MRI: `collect`, JRuby 10: `map &proc`, JRuby 1.7: `map` |
| Number Conversion | MRI: `map(&:to_i)`, JRuby 10: `Integer()`, JRuby 1.7: `map(&:to_i)` |
| Nil Handling | MRI: `compact.sum`, JRuby 10: `compact.sum`, JRuby 1.7: `\|\| default` |
| Object Duplication | `to_h` |
| Method Invocation | `direct` |
| Block/Yield | MRI: `each { }`, JRuby 10: `map { }`, JRuby 1.7: `each { }` |
| Eval | `direct (baseline)` |
| Caller | MRI: `caller_locations(0, 1)`, JRuby 10: `caller_locations(0, 1)`, JRuby 1.7: `caller()` |
| Marshal | `dump/load small 1k` |
| Memoization | `ivar \|\|= 100k` |
| Set vs Array | MRI: `Set reuse 1k 10k`, JRuby 10: `Set reuse 10 100k`, JRuby 1.7: `Set reuse 1k 10k` |
| Mutex | `no sync 100k` |
| Thread-local | `local var 100k` |
